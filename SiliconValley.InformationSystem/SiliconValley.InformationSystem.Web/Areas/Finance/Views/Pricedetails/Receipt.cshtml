
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Receipt</title>
    <link href="~/Scripts/layui/css/layui.css" rel="stylesheet" />
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script src="~/Scripts/layui/layui.js"></script>

    <style>


       

        table {
            /*border: 1px solid #808080;*/
            border-collapse: collapse
        }

            table tr td {
                height: 30px;
            }

        .titletr td{
            /*border: 1px solid #808080;*/
            text-align: center;
        }
        /*.bordes td {
            border: 1px solid #808080;
        }
        .motityle td {
            border: 1px solid #ffffff;
        }*/
        .wit{
            width:10%;
        }
        #guigu {
            margin-top:-20px;
            width:100px;
            height:100px;
         
        }
        /*table tr,table td,table th ,table{
            border: 1px solid red;
        }*/
        /*#shouju {
            background-image: url(/Areas/Finance/images/shouju.jpg)
        }*/
    </style>
</head>
<body>
 
    <div id="shouju" style="position:absolute;">
        <img src="~/Areas/Finance/images/shouju.jpg" style="width:890px;z-index:0;margin-top:-20px;" />
    </div>
    <div style="z-index:999;position:absolute;top:98px;left:18px;height:200px;" id="text">
        <OBJECT classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2" height="0" id="WebBrowser3" width="0" VIEWASTEXT></OBJECT>
        <table cellpadding="1" style="width:790px;">
            <tr>
                <td colspan="7" style="width:530px;"></td>
                <td colspan="1" style="text-align:center;">2020-06-23</td>
            </tr>

            <tr>
                <td style="width:90px;"></td>
                <th id="Name"></th>
                <td style="width:30px;"></td>
                <th id="classa">1710NA</th>
                <td style="width:60px;"></td>
                <th id="GrandName">S1</th>
                <td style="width:110px;"></td>
                <th id="identitydocument">431124200103303850</th>
            </tr>
            <tr>
                <td colspan="5"></td>
                <td colspan="3"></td>
            </tr>
            <tbody id="xiangmu" style="height:70px;"></tbody>

            <tbody id="xuezai" style="height:70px;">  </tbody>
            <tr>
                <td colspan="7" style="text-align:center;" id="DaXie">合计金额（大写）：</td>
                <td colspan="1" style="text-align:center;" id="pricent">2000</td>
            </tr>

        </table>
    </div>



    <div style="text-align:center;position:relative;top:471px;">
        <button class="layui-btn" id="btn">打印</button>
    </div>



</body>
</html>

<script src="~/Areas/Teachingquality/js/priceview.js"></script>
<script src="~/Areas/Teachingquality/js/AjaxAddupdate.js"></script>
<script>

       // window.parent.closeSelf();

    var studen = JSON.parse('@Html.Raw(ViewBag.student)');
    $("#GrandName").text(studen.GrandName);
    $("#Name").text(studen.Name);
    $("#StudentNumber").text(studen.StudentNumber);
    $("#classa").text(studen.classa);
    $("#identitydocument").text(studen.identitydocument);
    var Receiptdata = JSON.parse('@Html.Raw(ViewBag.Receiptdata)');
    console.log(Receiptdata);
    var count = 0;
    var ostitemsName = "";
    var Amountofmoneys = 0;
    var pricent = 0;
    for (var i = 0; i < Receiptdata.length; i++) {
        console.log(Receiptdata[i]);
        pricent = pricent + parseInt(Receiptdata[i].Amountofmoney);
        console.log(Receiptdata[i]);
        if (i==0) {
            //AddDate
            $("#Remarks").text(Receiptdata[i].Remarks);
            var date = new Date(Receiptdata[i].AddDate);
            $("#AddDate").text(getNowFormatDate(date));
        }
        if (Receiptdata[i].Rategory == "阶段费用缴纳" || Receiptdata[i].Rategory == "学费" || Receiptdata[i].Rategory == "食宿费") {
            var Amountofmoney = Receiptdata[i].Amountofmoney + ".00";
            $("#xiangmu").append($('<tr> <td colspan="4" style="text-align:center;">' + Receiptdata[i].GrandName + Receiptdata[i].ostitemsName + '</td> <td colspan="4" style="text-align:center;">' + Amountofmoney + '</td></tr>'));
           // $("#text thead").append($('<tr style="text-align:center;"><td colspan="6">' + Receiptdata[i].GrandName + Receiptdata[i].ostitemsName + '</td><td colspan="4">' + Amountofmoney + '</td></tr>'));
        } else if (Receiptdata[i].Rategory == "自考本科费用" || Receiptdata[i].Rategory=="其它") {
            var Amountofmoney = Receiptdata[i].Amountofmoney + ".00";
            $("#xiangmu").append($('<tr> <td colspan="4" style="text-align:center;">' + Receiptdata[i].Rategory + Receiptdata[i].ostitemsName + '</td> <td colspan="4" style="text-align:center;">' + Amountofmoney + '</td></tr>'));
           // $("#text thead").append($('<tr style="text-align:center;"><td colspan="6">' + Receiptdata[i].Rategory+"：" + Receiptdata[i].ostitemsName + '</td><td colspan="4">' + Amountofmoney + '</td></tr>'));
        }
        if (Receiptdata[i].Rategory == "学杂费") {
            count++;
            ostitemsName += Receiptdata[i].ostitemsName + ",";
            Amountofmoneys = Amountofmoneys + parseInt(Receiptdata[i].Amountofmoney);
            if (count ==3) {
                count = 0;
             
                $("#xuezai").append($('<tr> <td colspan="4" style="text-align:center;">' + ostitemsName.substring(0, ostitemsName.length - 1) + '</td> <td colspan="4" style="text-align:center;">' + Amountofmoneys + '.00</td></tr>'));

                //$("#text tbody").prepend($('<tr style="text-align:center;"><td colspan="6">' + ostitemsName.substring(0, ostitemsName.length - 1) + '</td><td colspan="4">' + Amountofmoneys + ".00" + '</td></tr>'));
                ostitemsName = "";
                Amountofmoneys = 0;
            }
        }

    }
    
    $("#pricent").text(toMoney(pricent));
    $("#DaXie").text(convertCurrency(pricent));

    if (count < 3 && count != 0) {
        $("#xuezai").append($('<tr> <td colspan="4" style="text-align:center;"><div>' + ostitemsName.substring(0, ostitemsName.length - 1) + '</div></td> <td colspan="4" style="text-align:center;">' + Amountofmoneys + '.00</td></tr>'));

    //    $("#text tbody").before($('<tr style="text-align:center;"><td colspan="6">' + ostitemsName.substring(0, ostitemsName.length - 1) + '</td><td colspan="4">' + Amountofmoneys + ".00" + '</td></tr>'));
    }
    if (count==0) {
        $("#xuezai").append($('<tr  style="height:1px;"> <td colspan="4" style="text-align:center;"></td> <td colspan="4" style="text-align:center;"></td></tr>'));

    }
    //if (Receiptdata.length > 1 && Receiptdata.length<4) {
    //    $("#text tbody").before($('<tr style="text-align:center;height: 30px;"></tr>'));
    //    $("#text tbody").before($('<tr style="text-align:center;height: 30px;"></tr>'));
    //    $("#text tbody").before($('<tr style="text-align:center;height: 30px;"></tr>'));
    //    console.log("aaaa");
    //} else if (Receiptdata.length > 3 && Receiptdata.length < 7) {
    //    console.log("aaaa");
    //    $("#text tbody").before($('<tr style="text-align:center;height: 30px;"></tr>'));
    //    $("#text tbody").before($('<tr style="text-align:center;height: 30px;"></tr>'));
    //} else if (Receiptdata.length > 7 && Receiptdata.length < 10) {
    //    console.log("aaaa");
    //    $("#text tbody").before($('<tr style="text-align:center;height: 30px;"></tr>'));
      
    //}
</script>

<script src="~/Areas/Teachingquality/js/Print.js"></script>
<script>
    document.getElementById('btn').onclick = function () {
    
        Print('#text', {
            //onStart: function () {
            //    console.log('onStart', new Date())
            //},
            //onEnd: function () {
            //    console.log('onEnd', new Date())
            //}
        })

    }
  

</script>