
@{
    Layout = null;
}

@model SiliconValley.InformationSystem.Entity.ViewEntity.ReconView
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Edit_rView</title>
    <link href="~/Scripts/layui/css/layui.css" rel="stylesheet" />
    <link href="~/Scripts/Tangmin_CssAndJs/com_js/MyOrther_tangmin.css" rel="stylesheet" />
    <style>
        .textCss1{
        color:red;
        }
        .AreatCss1
        {
            width: 100%;
            height: 100px;
            border-width: 1px;
            border-style: solid;
            background-color: #fff;
            border-radius: 2px;
        }
        .postionCs11{
        margin-left:200px;
        margin-top:-30px;
         float:right
        }
        .divCss1{
        width:260px;
        }
        .hideDiv{
        display:none;
        }
        .borCss{
        border:0px;
        }
        .iCss1
        {
            color: #009688;
            font-size: 30px;
            position:absolute;
            margin-top:-35px;
            margin-left:89%;
            cursor:pointer;
        }
        .layui-unselect
        {
            width: 100%;
            border-radius: 5px;
        }
          
    </style>
</head>
<body>
    <div style="width:90%;margin:0px auto;margin-top:20px;">
            <form class="layui-form" lay-filter="reidt_form">
                <div class="layui-row layui-form-item">
                    <div class="layui-col-x6 layui-col-sm6 layui-col-md6">
                        <label class="layui-form-label">班 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 级:</label>
                        <div class="layui-input-block">
                            @Html.HiddenFor(r => r.id)
                            @Html.HiddenFor(r=>r.classId)
                            <input type="text" value="@Model.class_name"  class="layui-input" disabled="disabled" id="className"/>   
                            <input type="hidden" name="Editclass_id" id="Editclass_id"/>
                            <i class="layui-icon layui-icon-search iCss1" id="Class_i" data-value="班级"></i>
                        </div>
                    </div>
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                        <label class="layui-form-label">教 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 室:</label>
                        <div class="layui-input-block">
                            <input type="text" id="ClassRoomName" value="@Model.classroom_name" disabled="disabled" class="layui-input" />
                            <input type="hidden" name="Editclassroom_id" id="Editclassroom_id" />
                            <i class="layui-icon layui-icon-search iCss1" id="Classroom_i" data-value="教室"></i>
                        </div>
                    </div>
                </div>
                <div class="layui-row layui-form-item">
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                        <label class="layui-form-label">课 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 程:</label>
                        <div class="layui-input-block">
                            <input type="text" value="@Model.currname" disabled="disabled" class="layui-input" id="curName" />
                            <input type="hidden" name="EditCurr_id" id="EditCurr_id" />
                            <i class="layui-icon layui-icon-search iCss1" id="Cur_i" data-value="课程"></i>
                        </div>
                    </div>
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                        <label class="layui-form-label">教学老师:</label>
                        @Html.HiddenFor(r => r.teachername)
                        <div id="teacher_div" class="layui-input-block">
                            <input type="text" value="@Model.teachername" disabled="disabled" class="layui-input" id="tracherName" />
                            <input type="hidden" name="EditTeacher_Id" id="EditTeacher_Id" />
                            <i class="layui-icon layui-icon-search iCss1" id="Teacher_i" data-value="老师"></i>
                        </div>
                    </div>
                </div>
                <div class="layui-row layui-form-item">
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                        <label class="LableCss1">上课时间:</label>
                        <div id="MytimeName_div" class="layui-input-block">
                            @Html.DropDownListFor(r => r.curdname, ViewBag.Time as List<SelectListItem>,new Dictionary<string, object>() { { "class", "layui-input" }})
                        </div>
                    </div>

                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                        <label class="LableCss1">排课日期:</label>
                        <div class="layui-input-block">
                            <input name="anpaidate" id="anpaidate" value="@Model.anpaidate" class="layui-input"/>                           
                        </div>
                    </div>
                </div>
                <div class="layui-row layui-form-item">
                    <div class="layui-col-xs12 layui-col-sm12 layui-col-md12">
                        <label class="LableCss1">修改原因:</label>
                        <div class="layui-input-block">
                            @Html.TextAreaFor(r => r.ramak, new Dictionary<string, object>() { { "class", "AreatCss1" }, { "lay-verify", "required" } })
                        </div>
                    </div>
                </div>

                <div class="layui-row layui-form-item" style="margin-top:60px;">
                    <div class="layui-col-xs12 layui-col-sm12 layui-col-md12">
                        <div style="width:47%;float:left;text-align:right">
                            <button type="submit" class="layui-btn" lay-submit="" lay-filter="Editview_add">编辑</button>
                        </div>
                        <div style="width:45%;float:left;margin-left:40px">
                            <input type="button" class="layui-btn" value="关闭" onclick="Myclose()" />
                        </div>


                    </div>
                </div>
            </form>      
    </div>  
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script src="~/Scripts/layui/layui.js"></script>
    <script src="~/Scripts/Tangmin_CssAndJs/com_js/MyOrther_tangmin.js"></script>
    <script>
        //点击图标修改数据 
        function EditClassData(id, value, str) {
            if (str == "班级") {
                //修改班级
                $("#Editclass_id")[0].value = id;
                $("#className")[0].value = value;
            } else if (str == "教室") {
                //修改教室
                $("#Editclassroom_id")[0].value = id;
                $("#ClassRoomName")[0].value = value;
            } else if (str == "课程") {
                $("#curName")[0].value = value;
                $("#EditCurr_id")[0].value = value;
            } else if (str == "老师") {
                $("#tracherName")[0].value = value;
                $("#EditTeacher_Id")[0].value = id;
            }
            
        }

        var mm = $("#teachername").val();
        var timename = $("#curdname").val();
        layui.use(['form','laydate'], function () {
            var form = layui.form;
            var laydate = layui.laydate;
            //时间初始化
            laydate.render({
                elem: '#anpaidate'
                , theme: 'molv'
                ,  trigger: 'click'
            });

            //监听提交
            form.on('submit(Editview_add)', function (data) {
                var indexof = layer.load(1);
                //console.log(data.field);
                $.ajax({
                    url: '/Educational/Reconcile/EditFunction',
                    data: data.field,
                    type: 'POST',
                    success: function (sud) {
                        layer.close(indexof);
                        if (sud.Success == true) {
                            layer.msg(sud.Msg, { icon: 1,shade:0.8 }, function () {
                                //刷新数据
                                window.parent.TableFulsh();
                                Myclose();
                            });
                        } else {
                            layer.msg(sud.Msg, { icon: 2 }, function () {
                                //刷新数据
                                window.parent.TableFulsh();
                            });
                        }
                    }
                });
                return false;
            });
           
        });
        //关闭弹出层
        function Myclose() {
            var layer = layui.layer;
            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
            parent.layer.close(index); //再执行关闭   
        }

        function cck() {
            $("#serch_div").removeClass("hideDiv");
            $("#img_div").addClass("hideDiv");
            layui.use(['form', 'table'], function () {
                var form = layui.form;
                var table = layui.table;
                table.render({
                    elem: '#emp_table'
                    , url: '/Educational/Reconcile/GetEmpTable'
                    , limits: [9]
                    , limit: 9
                    , page: true
                    , cols: [[
                        { field: 'id', title: '员工编号' }
                        , { field: 'empName', title: '员工名称 ' }
                        , { field: 'sex', title: '性别', width: 50 }
                        , { field: 'dementName', title: '部门' }
                        , { field: 'postionName', title: '岗位' }
                    ]]
                });
            });
        }

        function IClick(ele) {
            var curtype = $(ele).attr("data-value");
            curtype = curtype + "," + $("#classId").val();
            var layer = layui.layer;
            layer.open({
                type: 2,
                content: '/Educational/Reconcile/EditOrtherViewData/' + curtype
                ,area: ['500px', '400px']
                ,title: '选择数据'
                , shade: 0.8
                , anim: 4
                , skin: 'demo-class'
            });
        }

        //找到所有I标签
        $(function () {
            $("i").each(function (index, value) {
                $(value).attr("onclick", "IClick(this)");
            });
        });
         
        
    </script>
</body>
</html>
